<!-- Navbar -->
<%= render 'layouts/navbar' %>

<div class="posts-container">
  
  <div class="new-post-form-container" style="gap: 3em;">
    <img id="movie-poster-img" src="<%= asset_path('post/placeholder.jpg')%>" alt="Poster film" style="overflow: hidden; border-radius:0.5em;">
    <div class="post-card2"  style="height:25em">
      <div id="foto-titolo-creatore" style="display: flex; flex-direction: row; justify-content: center; align-items:center; border-bottom: 2px solid #FD7474; " >
        
        <%# <%= image_tag url_for(@user.avatar) + "?#{@user.avatar.blob.created_at.to_i}", alt: "Avatar", class: "post-avatar"%> 
        <%= image_tag "Profile_page/default_avatar.svg", alt: "Immagine di default", class: "post-avatar" %>         
        
        <div class="post-title" style="margin-top:1em; width:95%; margin-left:auto; margin-right:7em; border-radius:0.5em;">
          <h1><%= @post.title %></h1> <!-- titolo autore e contenuto post-->
          <p>Creato da <%= @post.user.username%></p>
        </div>
      </div>
      <div class="post-content">
        <h4><%= @post.content %></h4>
      </div>
    </div>
  </div>

</div>

<div class="posts-container">
  <div class="filters-container">

    <h2 class="post-title">Commenti</h1> 

    <div style="flex-shrink:0; background-color: green;">
        <button id="show-new-post-form", class="btn sign-up popup-button auth-button"> Commenta il Post</button>
    </div>
  </div>

  <div id="new-post-form-container" style="display:none;">
      <div class="new-post-card">
        <%= render 'comments/form', post: @post %> 
      </div>
  </div>

  <div id="comments" class="posts-container">
    <%= render @post.comments %>  <!-- carica i commenti del post ->_comment.html.erb -->
  </div>
</div> 


<h2>Dai la tua opinione!</h2>
<%= render 'comments/form', post: @post %>  <!-- carica form per aggiungere commento -> _form.html.erb-->


<!-- utilitÃ  opinabile -->
<%= link_to 'Edit', edit_post_path(@post) %>  <!-- non funziona-->
<%= link_to 'Ritorna al Forum', posts_path %>


<script>
  document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('show-new-post-form');
  const formContainer = document.getElementById('new-post-form-container');

  btn.addEventListener('click', () => {
    if (formContainer.style.display === 'none' || formContainer.style.display === '') {
      formContainer.style.display = 'block';
      btn.textContent = 'Annulla inserimento';
    } else {
      formContainer.style.display = 'none';
      btn.textContent = 'Commenta il post';
    }
  });
});
</script>

<!-- Footer -->
<%= render 'layouts/footer' %>